{"ast":null,"code":"'use strict';\n\nconst crypto = require('crypto');\n\nconst scmpCompare = require('./lib/scmpCompare');\n/**\n * Does a constant-time Buffer comparison by not short-circuiting\n * on first sign of non-equivalency.\n *\n * @param {Buffer} a The first Buffer to be compared against the second\n * @param {Buffer} b The second Buffer to be compared against the first\n * @return {Boolean}\n */\n\n\nmodule.exports = function scmp(a, b) {\n  // check that both inputs are buffers\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new Error('Both scmp args must be Buffers');\n  } // return early here if buffer lengths are not equal since timingSafeEqual\n  // will throw if buffer lengths are not equal\n\n\n  if (a.length !== b.length) {\n    return false;\n  } // use crypto.timingSafeEqual if available (since Node.js v6.6.0),\n  // otherwise use our own scmp-internal function.\n\n\n  if (crypto.timingSafeEqual) {\n    return crypto.timingSafeEqual(a, b);\n  }\n\n  return scmpCompare(a, b);\n};","map":{"version":3,"sources":["/Users/tony_niu/Visual Studio/Twilio/twilio-video-starter-kit/src/token-service/node_modules/scmp/index.js"],"names":["crypto","require","scmpCompare","module","exports","scmp","a","b","Buffer","isBuffer","Error","length","timingSafeEqual"],"mappings":"AAAA;;AAEA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAAtB;;AACA,MAAMC,WAAW,GAAGD,OAAO,CAAC,mBAAD,CAA3B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAE,MAAM,CAACC,OAAP,GAAiB,SAASC,IAAT,CAAeC,CAAf,EAAkBC,CAAlB,EAAqB;AACpC;AACA,MAAI,CAACC,MAAM,CAACC,QAAP,CAAgBH,CAAhB,CAAD,IAAuB,CAACE,MAAM,CAACC,QAAP,CAAgBF,CAAhB,CAA5B,EAAgD;AAC9C,UAAM,IAAIG,KAAJ,CAAU,gCAAV,CAAN;AACD,GAJmC,CAMpC;AACA;;;AACA,MAAIJ,CAAC,CAACK,MAAF,KAAaJ,CAAC,CAACI,MAAnB,EAA2B;AACzB,WAAO,KAAP;AACD,GAVmC,CAYpC;AACA;;;AACA,MAAIX,MAAM,CAACY,eAAX,EAA4B;AAC1B,WAAOZ,MAAM,CAACY,eAAP,CAAuBN,CAAvB,EAA0BC,CAA1B,CAAP;AACD;;AAED,SAAOL,WAAW,CAACI,CAAD,EAAIC,CAAJ,CAAlB;AACD,CAnBD","sourcesContent":["'use strict'\n\nconst crypto = require('crypto')\nconst scmpCompare = require('./lib/scmpCompare')\n\n/**\n * Does a constant-time Buffer comparison by not short-circuiting\n * on first sign of non-equivalency.\n *\n * @param {Buffer} a The first Buffer to be compared against the second\n * @param {Buffer} b The second Buffer to be compared against the first\n * @return {Boolean}\n */\nmodule.exports = function scmp (a, b) {\n  // check that both inputs are buffers\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new Error('Both scmp args must be Buffers')\n  }\n\n  // return early here if buffer lengths are not equal since timingSafeEqual\n  // will throw if buffer lengths are not equal\n  if (a.length !== b.length) {\n    return false\n  }\n\n  // use crypto.timingSafeEqual if available (since Node.js v6.6.0),\n  // otherwise use our own scmp-internal function.\n  if (crypto.timingSafeEqual) {\n    return crypto.timingSafeEqual(a, b)\n  }\n\n  return scmpCompare(a, b)\n}\n"]},"metadata":{},"sourceType":"module"}